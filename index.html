<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Latiao System Doctor</title>
    <style>
        body { background-color: #000; color: #0f0; font-family: 'Courier New', monospace; padding: 20px; font-size: 14px; line-height: 1.5; }
        .log { margin-bottom: 5px; border-bottom: 1px solid #333; padding-bottom: 2px; }
        .error { color: #ff3333; font-weight: bold; }
        .success { color: #00ff00; }
        .info { color: #ffff00; }
        button { background: #333; color: white; border: 1px solid #fff; padding: 15px; width: 100%; margin-top: 20px; font-size: 18px; border-radius: 8px; }
        h1 { border-bottom: 2px solid white; padding-bottom: 10px; }
    </style>
</head>
<body>

    <h1>üè• Latiao System Doctor</h1>
    <div id="console"></div>
    <button onclick="fullWipe()">‚ò¢Ô∏è –ü–†–ò–ú–£–°–û–í–ï –û–ß–ò–©–ï–ù–ù–Ø (WIPE)</button>

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
        const consoleDiv = document.getElementById('console');

        function log(msg, type = 'normal') {
            const div = document.createElement('div');
            div.className = 'log ' + type;
            div.innerText = `> ${msg}`;
            consoleDiv.appendChild(div);
        }

        function error(msg) { log(msg, 'error'); }
        function success(msg) { log(msg, 'success'); }

        // 1. –ü–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –≥–ª–æ–±–∞–ª—å–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫
        window.onerror = function(message, source, lineno, colno, errorObj) {
            error(`CRITICAL ERROR: ${message} (Line: ${lineno})`);
            return true;
        };

        // 2. –¢–µ—Å—Ç –±—ñ–±–ª—ñ–æ—Ç–µ–∫
        log("1. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫...");
        if (window.React) success("React –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ."); else error("React –ù–ï –ó–ù–ê–ô–î–ï–ù–û!");
        if (window.ReactDOM) success("ReactDOM –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ."); else error("ReactDOM –ù–ï –ó–ù–ê–ô–î–ï–ù–û!");
        if (window.Babel) success("Babel –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ."); else error("Babel –ù–ï –ó–ù–ê–ô–î–ï–ù–û!");

        // 3. –¢–µ—Å—Ç —Å—Ö–æ–≤–∏—â–∞
        log("2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ö–æ–≤–∏—â–∞...");
        try {
            const testKey = 'latiao_test';
            localStorage.setItem(testKey, 'ok');
            if (localStorage.getItem(testKey) === 'ok') {
                localStorage.removeItem(testKey);
                success("LocalStorage –ø—Ä–∞—Ü—é—î —Å–ø—Ä–∞–≤–Ω–æ.");
            } else {
                error("LocalStorage –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î.");
            }
        } catch (e) {
            error("–î–æ—Å—Ç—É–ø –¥–æ LocalStorage –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ: " + e.message);
        }

        // 4. –§—É–Ω–∫—Ü—ñ—è –ø–æ–≤–Ω–æ–≥–æ —Å—Ç–∏—Ä–∞–Ω–Ω—è
        window.fullWipe = async function() {
            log("--- –ü–û–ß–ê–¢–û–ö –ü–†–ò–ú–£–°–û–í–û–ì–û –û–ß–ò–©–ï–ù–ù–Ø ---", 'info');
            
            try {
                // –û—á–∏—â–µ–Ω–Ω—è LocalStorage
                localStorage.clear();
                success("LocalStorage –æ—á–∏—â–µ–Ω–æ.");

                // –û—á–∏—â–µ–Ω–Ω—è SessionStorage
                sessionStorage.clear();
                success("SessionStorage –æ—á–∏—â–µ–Ω–æ.");

                // –û—á–∏—â–µ–Ω–Ω—è Service Workers (–∫–µ—à PWA)
                if ('serviceWorker' in navigator) {
                    const registrations = await navigator.serviceWorker.getRegistrations();
                    for(let registration of registrations) {
                        await registration.unregister();
                        success("ServiceWorker –∑—É–ø–∏–Ω–µ–Ω–æ.");
                    }
                }

                // –û—á–∏—â–µ–Ω–Ω—è IndexedDB (–Ω–∞–π—á–∞—Å—Ç—ñ—à–∞ –ø—Ä–∏—á–∏–Ω–∞ –∑–∞–≤–∏—Å–∞–Ω–Ω—è Firebase)
                const dbs = await window.indexedDB.databases();
                dbs.forEach(db => {
                    window.indexedDB.deleteDatabase(db.name);
                    success(`–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö '${db.name}' –≤–∏–¥–∞–ª–µ–Ω–∞.`);
                });

                log("--- –ì–û–¢–û–í–û! –°–ò–°–¢–ï–ú–ê –ß–ò–°–¢–ê ---", 'success');
                alert("–°–∏—Å—Ç–µ–º—É –ø–æ–≤–Ω—ñ—Å—Ç—é –æ—á–∏—â–µ–Ω–æ. –¢–µ–ø–µ—Ä –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –æ—Å–Ω–æ–≤–Ω–∏–π –∫–æ–¥ v17.0.");
            } catch (e) {
                error("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—á–∏—â–µ–Ω–Ω—ñ: " + e.message);
                alert("–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞. –°–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É —ñ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ —â–µ —Ä–∞–∑.");
            }
        };

        log("–û—á—ñ–∫—É–≤–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∏...", 'info');
    </script>
</body>
</html>
